{"version":3,"sources":["../../modules/line-chart/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport {createElement} from 'react-faux-dom';\nimport {reduce, calcMargin, getValueFunction, getRandomId, setLineDomainAndRange, defaultStyle, getAxisStyles, createCircularTicks, rmaColorPalet} from '../shared';\nimport {select, svg, time, event as d3LastEvent} from 'd3';\nimport {Style} from 'radium';\nimport merge from 'lodash.merge';\nimport {format} from 'd3-time-format';\n\nexport default class LineChart extends React.Component {\n  static get propTypes() {\n    return {\n      data: React.PropTypes.array.isRequired,\n      width: React.PropTypes.number,\n      height: React.PropTypes.number,\n      xType: React.PropTypes.string,\n      yType: React.PropTypes.string,\n      datePattern: React.PropTypes.string,\n      interpolate: React.PropTypes.string,\n      style: React.PropTypes.object,\n      margin: React.PropTypes.object,\n      axes: React.PropTypes.bool,\n      grid: React.PropTypes.bool,\n      verticalGrid: React.PropTypes.bool,\n      xDomainRange: React.PropTypes.array,\n      yDomainRange: React.PropTypes.array,\n      axisLabels: React.PropTypes.object,\n      tickTimeDisplayFormat: React.PropTypes.string,\n      yTicks: React.PropTypes.number,\n      xTicks: React.PropTypes.number,\n      dataPoints: React.PropTypes.bool,\n      lineColors: React.PropTypes.array,\n      yAxisOrientRight: React.PropTypes.bool,\n      mouseOverHandler: React.PropTypes.func,\n      mouseOutHandler: React.PropTypes.func,\n      mouseMoveHandler: React.PropTypes.func,\n      clickHandler: React.PropTypes.func\n    };\n  }\n\n  static get defaultProps() {\n    return {\n      width: 200,\n      height: 150,\n      datePattern: '%d-%b-%y',\n      interpolate: 'linear',\n      axes: false,\n      xType: 'linear',\n      yType: 'linear',\n      lineColors: [],\n      axisLabels: {x: '', y: ''},\n      mouseOverHandler: () => {},\n      mouseOutHandler: () => {},\n      mouseMoveHandler: () => {},\n      clickHandler: () => {}\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.parseDate = format(props.datePattern).parse;\n    this.uid = getRandomId();\n  }\n\n  componentDidMount() {\n    createCircularTicks(this.refs[this.uid]);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.width !== prevProps.width) {\n      createCircularTicks(this.refs[this.uid]);\n    }\n  }\n\n  render() {\n    const {data,\n      xType,\n      yType,\n      style,\n      axes,\n      axisLabels,\n      xDomainRange,\n      yDomainRange,\n      xTicks,\n      yTicks,\n      interpolate,\n      grid,\n      verticalGrid,\n      tickTimeDisplayFormat,\n      mouseOverHandler,\n      mouseOutHandler,\n      mouseMoveHandler,\n      clickHandler,\n      dataPoints,\n      lineColors,\n      yAxisOrientRight} = this.props;\n    const margin = calcMargin(axes, this.props.margin, yAxisOrientRight);\n    const defaultColours = lineColors.concat(rmaColorPalet);\n    const width = reduce(this.props.width, margin.left, margin.right);\n    const height = reduce(this.props.height, margin.top, margin.bottom);\n\n    const x = setLineDomainAndRange('x', xDomainRange, data, xType, width, this.parseDate);\n    const y = setLineDomainAndRange('y', yDomainRange, data, yType, height, this.parseDate);\n\n    const yValue = getValueFunction('y', yType, this.parseDate);\n    const xValue = getValueFunction('x', xType, this.parseDate);\n    const linePath = svg.line().interpolate(interpolate).x((d) => x(xValue(d))).y((d) => y(yValue(d)));\n\n    const svgNode = createElement('svg');\n    select(svgNode).attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom);\n    const root = select(svgNode).append('g').attr('transform', `translate(${margin.left},${margin.top})`);\n\n    if (axes) {\n      const xAxis = svg.axis().scale(x).orient('bottom');\n      if (xType === 'time' && tickTimeDisplayFormat) {\n        xAxis.tickFormat(time.format(tickTimeDisplayFormat));\n      }\n      if (grid && verticalGrid) { xAxis.tickSize(-height, 6).tickPadding(15); } else { xAxis.tickSize(0).tickPadding(15);}\n      if (xTicks) xAxis.ticks(xTicks);\n      root.append('g')\n        .attr('class', 'x axis')\n        .attr('transform', `translate(0,${height})`)\n        .call(xAxis)\n        .append('text')\n        .attr('class', 'label')\n        .attr('y', margin.bottom - 10)\n        .attr('x', yAxisOrientRight ? 0 : width)\n        .style('text-anchor', yAxisOrientRight ? 'start' : 'end')\n        .text(axisLabels.x);\n\n      const yAxis = svg.axis().scale(y)\n        .orient(yAxisOrientRight ? 'right' : 'left');\n      if (yType === 'time' && tickTimeDisplayFormat) {\n        yAxis.tickFormat(time.format(tickTimeDisplayFormat));\n      }\n      if (grid) { yAxis.tickSize(-width, 6).tickPadding(12); } else { yAxis.tickPadding(10); }\n      if (yTicks) yAxis.ticks(yTicks);\n      root.append('g')\n        .attr('class', 'y axis')\n        .call(yAxis)\n        .attr('transform', yAxisOrientRight ? `translate(${width}, 0)` : `translate(0, 0)`)\n        .append('text')\n        .attr('class', 'label')\n        .attr('transform', 'rotate(-90)')\n        .attr('x', 0)\n        .attr('y', yAxisOrientRight ? -20 + margin.right : 0 - margin.left)\n        .attr('dy', '.9em')\n        .style('text-anchor', 'end')\n        .text(axisLabels.y);\n    }\n\n    data.map((dataElelment, i) => {\n      root.append('path')\n        .datum(dataElelment)\n        .attr('class', `line`)\n        .attr('style', `stroke: ${defaultColours[i]}`)\n        .attr('d', linePath);\n    });\n\n    if (dataPoints) {\n      data.map((dataElelment, i) => {\n        dataElelment.map((dotData) => {\n          root.append('circle')\n          .attr('class', 'data-point')\n          .style('strokeWidth', '2px')\n          .style('stroke', defaultColours[i])\n          .style('fill', 'white')\n          .attr('cx', () => {\n            switch (xType) {\n              case ('time'):\n                return x(this.parseDate(dotData.x));\n              default:\n                return x(dotData.x);\n            }\n          })\n          .attr('cy', () => {\n            switch (yType) {\n              case ('time'):\n                return y(this.parseDate(dotData.y));\n              default:\n                return y(dotData.y);\n            }\n          })\n          .on('mouseover', () => mouseOverHandler(dotData, d3LastEvent))\n          .on('mouseout', () => mouseOutHandler(dotData, d3LastEvent))\n          .on('mousemove', () => mouseMoveHandler(d3LastEvent))\n          .on('click', () => clickHandler(dotData, d3LastEvent));\n        });\n      });\n    }\n\n\n    return (\n      <div ref={this.uid} className={`line-chart${this.uid}`}>\n        <Style scopeSelector={`.line-chart${this.uid}`} rules={merge({}, defaultStyle, style, getAxisStyles(grid, verticalGrid, yAxisOrientRight))}/>\n        {svgNode.toReact()}\n      </div>\n    );\n  }\n}\n"]}